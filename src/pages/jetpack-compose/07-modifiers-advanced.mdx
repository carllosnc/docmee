---
layout: ../../layout/main-layout.astro
---
<a href="/jetpack-compose">← Jetpack Compose </a> <br /> <br />

# Advanced: Modifier.shadow(), Modifier.animateContentSize()

Advanced visual and animation modifiers for creating elevated UI elements and smooth size transitions.

## Basic Shadow Usage

```kotlin
@Composable
fun BasicShadows() {
    Column(
        modifier = Modifier.padding(24.dp),
        verticalArrangement = Arrangement.spacedBy(24.dp)
    ) {
        // Simple shadow
        Box(
            modifier = Modifier
                .size(100.dp)
                .shadow(4.dp)
                .background(Color.White)
        )
        
        // Shadow with shape
        Box(
            modifier = Modifier
                .size(100.dp)
                .shadow(8.dp, RoundedCornerShape(16.dp))
                .background(Color.White, RoundedCornerShape(16.dp))
        )
        
        // Circular shadow
        Box(
            modifier = Modifier
                .size(100.dp)
                .shadow(6.dp, CircleShape)
                .background(Color.White, CircleShape)
        )
        
        // No clip shadow (shadow extends beyond shape)
        Box(
            modifier = Modifier
                .size(100.dp)
                .shadow(12.dp, RoundedCornerShape(8.dp), clip = false)
                .background(Color.White, RoundedCornerShape(8.dp))
        )
    }
}
```

Shadow shape must match background shape. Use `clip = false` for shadows that extend beyond bounds.

## Shadow Elevation Levels

```kotlin
@Composable
fun ShadowElevationLevels() {
    LazyColumn(
        modifier = Modifier.padding(16.dp),
        verticalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        // Material Design elevation levels
        val elevations = listOf(0.dp, 1.dp, 2.dp, 4.dp, 6.dp, 8.dp, 12.dp, 16.dp, 24.dp)
        
        items(elevations) { elevation ->
            Card(
                modifier = Modifier
                    .fillMaxWidth()
                    .shadow(elevation, RoundedCornerShape(8.dp))
                    .background(Color.White, RoundedCornerShape(8.dp))
            ) {
                Text(
                    text = "Elevation: ${elevation.value}dp",
                    modifier = Modifier.padding(16.dp),
                    style = MaterialTheme.typography.bodyLarge
                )
            }
        }
    }
}
```

Follow Material Design elevation levels for consistent depth hierarchy.

## Animated Shadow

```kotlin
@Composable
fun AnimatedShadow() {
    var isElevated by remember { mutableStateOf(false) }
    
    val animatedElevation by animateDpAsState(
        targetValue = if (isElevated) 16.dp else 2.dp,
        animationSpec = spring(
            dampingRatio = Spring.DampingRatioMediumBouncy,
            stiffness = Spring.StiffnessLow
        ),
        label = "elevation"
    )
    
    Box(
        modifier = Modifier
            .size(120.dp)
            .clickable { isElevated = !isElevated }
            .shadow(animatedElevation, RoundedCornerShape(12.dp))
            .background(Color.White, RoundedCornerShape(12.dp)),
        contentAlignment = Alignment.Center
    ) {
        Text(
            if (isElevated) "Elevated!" else "Tap to lift",
            textAlign = TextAlign.Center
        )
    }
}
```

Animate elevation for interactive feedback. Use spring animations for natural feel.

## Custom Shadow Colors

```kotlin
@Composable
fun CustomShadowColors() {
    Row(
        modifier = Modifier.padding(16.dp),
        horizontalArrangement = Arrangement.spacedBy(16.dp)
    ) {
        // Custom shadow using drawBehind
        Box(
            modifier = Modifier
                .size(100.dp)
                .drawBehind {
                    drawRoundRect(
                        color = Color.Red.copy(alpha = 0.3f),
                        cornerRadius = CornerRadius(8.dp.toPx()),
                        size = size,
                        topLeft = Offset(4.dp.toPx(), 4.dp.toPx())
                    )
                }
                .background(Color.White, RoundedCornerShape(8.dp))
        )
        
        // Colored shadow with blur effect
        Box(
            modifier = Modifier
                .size(100.dp)
                .drawBehind {
                    // Multiple shadow layers for blur effect
                    repeat(5) { i ->
                        val offset = (i + 1) * 2f
                        val alpha = 0.1f - (i * 0.015f)
                        drawRoundRect(
                            color = Color.Blue.copy(alpha = alpha),
                            cornerRadius = CornerRadius(8.dp.toPx()),
                            size = size,
                            topLeft = Offset(offset, offset)
                        )
                    }
                }
                .background(Color.White, RoundedCornerShape(8.dp))
        )
    }
}
```

Use `drawBehind` for custom shadow colors and effects not available in standard shadow.

## Basic animateContentSize

```kotlin
@Composable
fun BasicAnimateContentSize() {
    var isExpanded by remember { mutableStateOf(false) }
    
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .padding(16.dp)
            .clickable { isExpanded = !isExpanded }
            .animateContentSize() // Automatically animates size changes
    ) {
        Column(modifier = Modifier.padding(16.dp)) {
            Text(
                "Expandable Card",
                style = MaterialTheme.typography.headlineSmall
            )
            
            if (isExpanded) {
                Spacer(modifier = Modifier.height(8.dp))
                Text(
                    "This content appears with smooth animation when expanded. " +
                    "The animateContentSize modifier automatically handles the size transition " +
                    "when content is added or removed.",
                    style = MaterialTheme.typography.bodyMedium
                )
                
                Spacer(modifier = Modifier.height(8.dp))
                
                repeat(3) { index ->
                    Text(
                        "• Additional item ${index + 1}",
                        style = MaterialTheme.typography.bodySmall,
                        modifier = Modifier.padding(vertical = 2.dp)
                    )
                }
            }
        }
    }
}
```

`animateContentSize()` automatically animates when composable content changes size.

## Custom Animation Specs

```kotlin
@Composable
fun CustomAnimateContentSize() {
    var isExpanded by remember { mutableStateOf(false) }
    
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .padding(16.dp)
            .clickable { isExpanded = !isExpanded }
            .animateContentSize(
                animationSpec = spring(
                    dampingRatio = Spring.DampingRatioLowBouncy,
                    stiffness = Spring.StiffnessMedium
                )
            )
    ) {
        Column(modifier = Modifier.padding(16.dp)) {
            Row(
                modifier = Modifier.fillMaxWidth(),
                horizontalArrangement = Arrangement.SpaceBetween,
                verticalAlignment = Alignment.CenterVertically
            ) {
                Text(
                    "Bouncy Animation",
                    style = MaterialTheme.typography.headlineSmall
                )
                Icon(
                    imageVector = if (isExpanded) Icons.Default.ExpandLess else Icons.Default.ExpandMore,
                    contentDescription = null
                )
            }
            
            if (isExpanded) {
                Spacer(modifier = Modifier.height(12.dp))
                
                LazyColumn(
                    modifier = Modifier.height(200.dp),
                    verticalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    items(10) { index ->
                        Card(
                            colors = CardDefaults.cardColors(
                                containerColor = MaterialTheme.colorScheme.surfaceVariant
                            )
                        ) {
                            Text(
                                "List item ${index + 1}",
                                modifier = Modifier.padding(12.dp)
                            )
                        }
                    }
                }
            }
        }
    }
}
```

Customize animation with different spring parameters for unique feel.

## Dynamic Content Lists

```kotlin
@Composable
fun DynamicContentList() {
    var items by remember { mutableStateOf(listOf("Item 1", "Item 2")) }
    
    Column(
        modifier = Modifier
            .fillMaxWidth()
            .padding(16.dp)
            .animateContentSize(
                animationSpec = tween(
                    durationMillis = 300,
                    easing = FastOutSlowInEasing
                )
            )
    ) {
        Row(
            modifier = Modifier.fillMaxWidth(),
            horizontalArrangement = Arrangement.spacedBy(8.dp)
        ) {
            Button(
                onClick = { 
                    items = items + "Item ${items.size + 1}"
                }
            ) {
                Text("Add")
            }
            
            Button(
                onClick = { 
                    if (items.isNotEmpty()) {
                        items = items.dropLast(1)
                    }
                },
                enabled = items.isNotEmpty()
            ) {
                Text("Remove")
            }
        }
        
        Spacer(modifier = Modifier.height(16.dp))
        
        items.forEach { item ->
            Card(
                modifier = Modifier
                    .fillMaxWidth()
                    .padding(vertical = 4.dp)
            ) {
                Text(
                    text = item,
                    modifier = Modifier.padding(16.dp)
                )
            }
        }
    }
}
```

Use with dynamic content to smooth transitions when items are added/removed.

## Combining Shadow and Content Size Animation

```kotlin
@Composable
fun ShadowWithContentAnimation() {
    var isExpanded by remember { mutableStateOf(false) }
    
    val animatedElevation by animateDpAsState(
        targetValue = if (isExpanded) 12.dp else 4.dp,
        animationSpec = spring(dampingRatio = Spring.DampingRatioMediumBouncy),
        label = "elevation"
    )
    
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .padding(16.dp)
            .shadow(animatedElevation, RoundedCornerShape(16.dp))
            .background(Color.White, RoundedCornerShape(16.dp))
            .clickable { isExpanded = !isExpanded }
            .animateContentSize(
                animationSpec = spring(
                    dampingRatio = Spring.DampingRatioMediumBouncy,
                    stiffness = Spring.StiffnessMedium
                )
            )
    ) {
        Column(modifier = Modifier.padding(20.dp)) {
            Row(
                modifier = Modifier.fillMaxWidth(),
                horizontalArrangement = Arrangement.SpaceBetween,
                verticalAlignment = Alignment.CenterVertically
            ) {
                Text(
                    "Interactive Card",
                    style = MaterialTheme.typography.headlineMedium,
                    fontWeight = FontWeight.Bold
                )
                
                Icon(
                    imageVector = if (isExpanded) Icons.Default.Favorite else Icons.Default.FavoriteBorder,
                    contentDescription = null,
                    tint = if (isExpanded) Color.Red else Color.Gray
                )
            }
            
            if (isExpanded) {
                Spacer(modifier = Modifier.height(16.dp))
                
                Text(
                    "Detailed Information",
                    style = MaterialTheme.typography.titleMedium,
                    fontWeight = FontWeight.SemiBold
                )
                
                Spacer(modifier = Modifier.height(8.dp))
                
                Text(
                    "This card demonstrates the combination of shadow animation and content size animation. " +
                    "The elevation increases when expanded, providing visual feedback that the content is now prominent.",
                    style = MaterialTheme.typography.bodyMedium,
                    lineHeight = 20.sp
                )
                
                Spacer(modifier = Modifier.height(16.dp))
                
                Row(
                    horizontalArrangement = Arrangement.spacedBy(12.dp)
                ) {
                    repeat(3) { index ->
                        Box(
                            modifier = Modifier
                                .size(60.dp)
                                .shadow(2.dp, CircleShape)
                                .background(
                                    listOf(Color.Blue, Color.Green, Color.Orange)[index],
                                    CircleShape
                                ),
                            contentAlignment = Alignment.Center
                        ) {
                            Text(
                                "${index + 1}",
                                color = Color.White,
                                fontWeight = FontWeight.Bold
                            )
                        }
                    }
                }
            }
        }
    }
}
```

## Performance Considerations

```kotlin
@Composable
fun OptimizedAnimations() {
    var isExpanded by remember { mutableStateOf(false) }
    
    // Memoize expensive calculations
    val animationSpec = remember {
        spring<Dp>(
            dampingRatio = Spring.DampingRatioMediumBouncy,
            stiffness = Spring.StiffnessMedium
        )
    }
    
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .padding(16.dp)
            .clickable { isExpanded = !isExpanded }
            .animateContentSize(animationSpec = animationSpec)
    ) {
        Column(modifier = Modifier.padding(16.dp)) {
            Text("Optimized Card")
            
            // Use AnimatedVisibility for complex content
            AnimatedVisibility(
                visible = isExpanded,
                enter = fadeIn() + slideInVertically(),
                exit = fadeOut() + slideOutVertically()
            ) {
                Column {
                    Spacer(modifier = Modifier.height(8.dp))
                    repeat(5) { index ->
                        Text(
                            "Content line ${index + 1}",
                            modifier = Modifier.padding(vertical = 2.dp)
                        )
                    }
                }
            }
        }
    }
}
```

## Key Principles

- **Shadow consistency**: match shadow shape with background shape
- **Elevation hierarchy**: follow Material Design elevation system (0-24dp)
- **Animation specs**: use spring animations for natural shadow transitions
- **Content size**: `animateContentSize()` works automatically with content changes
- **Performance**: memoize animation specs and use `AnimatedVisibility` for complex content
- **Custom shadows**: use `drawBehind` for colored or custom shadow effects
- **Clip behavior**: use `clip = false` for shadows extending beyond bounds